已完成对参考应用 nian 的分析，并结合您的AI功能需求，初步整理了AI日记App的核心功能清单。接下来，我将开始设计应用的整体架构和数据流向。

# AI日记App核心功能需求

## 一、标准日记功能 (参考 "nian" 及通用日记应用):

1.  **用户认证与管理:**
    *   注册 (邮箱/密码，可选社交登录)。
    *   登录与登出。
    *   密码找回。
    *   用户个人资料管理 (头像、昵称等)。
2.  **日记条目创建与管理:**
    *   创建带标题和富文本内容的新日记条目。支持多种日记类型 (`diary_type`)，例如标准文本、感恩日记、梦境记录、AI辅助反思、对话记录等。
    *   富文本编辑器: 支持加粗、斜体、下划线、列表 (项目符号、数字编号)、标题、引用块、代码块、超链接等。
    *   媒体附件: 图片、音频记录 (用于语音笔记/听写)、短视频片段 (可选)。附件可以有特定用途 (`attachment_purpose`)，如内联内容、条目封面 (`cover_image_attachment_id`)。
    *   条目日期和时间戳 (自动记录，支持手动调整)。
    *   条目心情跟踪/标记 (例如：开心、难过、高效，或更细化的情感标签)。
    *   自定义标签，用于组织条目。
    *   个性化条目外观：支持设置封面图片、背景样式 (`background_style_json`，如纯色、背景图片、渐变)。
    *   特定条目配置：支持针对条目的自定义设置 (`custom_settings_json`)，例如AI交互参数、显示选项等。
    *   排序与置顶：支持条目置顶 (`is_pinned`) 和自定义排序 (`sort_index`)。
    *   搜索功能: 按关键词、日期范围、标签、心情、日记类型搜索。
    *   条目查看方式: 日历视图、时间轴视图、列表视图。
    *   编辑和删除日记条目。
    *   草稿自动保存功能。
3.  **清单管理 (待办事项/清单):**
    *   创建带标题的新清单。支持多种清单类型 (`list_type`)，例如标准待办、目标追踪器、普通清单等。
    *   向清单中添加项目。
    *   标记项目为完成/未完成。
    *   重新排序清单项目。
    *   为清单项目设置截止日期/提醒 (可选，可作为后续版本功能)。
    *   清单分类或标记。
    *   目标追踪型清单: 支持设置目标进度 (`target_progress`)、当前进度 (`current_progress`) 和进度单位 (`progress_unit`)。
    *   个性化清单外观：支持设置封面图片 (`cover_image_attachment_id`)、背景样式 (`background_style_json`)。
    *   特定清单配置：支持针对清单的自定义设置 (`custom_settings_json`)。
    *   排序与置顶：支持清单置顶 (`is_pinned`) 和自定义排序 (`sort_index`)。
4.  **组织与导航:**
    *   笔记本/文件夹: 允许用户将日记或清单分组到不同的笔记本或文件夹 (例如："个人日记"、"工作笔记"、"灵感记录")。
    *   时间轴/日历视图: 便捷浏览历史条目。
    *   强大的全局搜索和筛选功能。
5.  **个性化与设置:**
    *   主题选择 (浅色/深色模式，强调色)。
    *   阅读和写作的字体定制。
    *   通知偏好设置 (例如：写作提醒)。
    *   数据备份与恢复选项 (例如：导出为PDF/TXT，云同步)。
    *   隐私设置 (例如：应用密码锁)。

## 二、AI驱动功能 (根据用户需求):

1.  **AI辅助写作:**
    *   **内容生成/建议:**
        *   基于上下文的句子补全/建议。
        *   基于关键词或起始句的段落生成。
        *   日记主题的灵感生成 (例如："今天我该写些什么？")。
        *   长篇条目的内容摘要。
    *   **内容改进:**
        *   语法和拼写纠错。
        *   风格和语气建议 (例如：使其更具反思性、更正式)。
        *   词汇润色与增强。
    *   **模板化写作:** AI辅助填写特定类型条目的预定义模板 (例如：感恩日记、梦境记录、每日反思)。
2.  **AI对话式日记/清单创建:**
    *   **对话界面:** 用户可以通过与AI"交谈"来记录日记条目或创建清单。
        *   示例：用户说："AI，为今天新建一篇日记。我去了公园，感觉很放松。"
        *   示例：用户说："AI，创建一个名为'购物单'的待办事项清单，并添加牛奶、鸡蛋和面包。"
    *   **追问引导:** AI可以提出引导性问题，以获取更多日记或清单的细节。
        *   示例：AI："能详细说说在公园里是什么让您感到放松吗？"
    *   **语音转文字听写:** 将口述语言无缝转换为文本，用于日记条目或清单项目。
3.  **AI驱动的洞察与反思 (高级功能):**
    *   **情绪分析:** 分析文本以识别一段时间内的主要情绪或情感状态。
    *   **主题检测:** 识别日记条目中反复出现的主题或议题。
    *   **个性化提示:** 基于过往条目或检测到的模式，推荐反思性问题。
    *   **情绪趋势可视化:** 展示数周或数月内情绪/情感的变化情况。
4.  **多API模型选择:**
    *   **用户可选的AI模型:** 允许用户通过API集成选择不同的AI模型/提供商 (例如：OpenAI GPT系列、Anthropic Claude、Google Gemini，或可行的开源模型)。
    *   **配置面板:** 设置区域，用户可以在此输入API密钥 (如果模型提供商要求) 或从应用提供的预配置免费/付费层级中选择。
    *   **模型特定能力:** UI应能适应所选模型的特性，或告知用户其优缺点及特定功能。

## 三、通用应用功能:

1.  **跨平台同步 (可选但推荐):** 在多个设备 (iOS、Android、Web) 间同步数据。
2.  **离线访问:** 即使没有网络连接也能创建和查看条目，联网后自动同步。
3.  **导出选项:** 以多种格式 (PDF、TXT、Markdown) 导出日记/清单。
4.  **安全与隐私:**
    *   敏感数据的端到端加密 (尤其在启用云同步时)。
    *   本地数据加密。
    *   清晰的关于AI数据使用的隐私政策。
5.  **用户界面 (UI) 与用户体验 (UX):**
    *   简洁、直观且美观的设计。
    *   便捷的导航。
    *   针对不同屏幕尺寸的响应式设计。

## 四、人脉关系管理与情商辅助功能

### 1. 核心功能 (Features)：

*   **人物档案记录 (Profile Recording)：**
    *   记录朋友、亲人等联系人的基础信息，如：兴趣爱好、口味、重要日期（生日等）。**AI辅助：可从日记、对话记录（用户授权后）中智能提取并建议待记录的人物信息。**
    *   记录与人物相关的往来事情，如：重要对话摘要、发生的事件、承诺、共同经历、金钱往来等。**AI辅助：可对长对话进行摘要，自动识别事件、承诺等关键信息，并关联到对应人物。**
    *   结构化、分类记录，而非简单的备忘录。**AI辅助：根据记录内容自动推荐标签或分类。**
*   **智能提醒 (Intelligent Reminders)：**
    *   基于记录的内容（如纪念日、重要事件），设置关键节点的提醒，避免遗忘。**AI辅助：分析互动模式和记录内容，预测潜在的重要跟进事项或联系时机，并提供更智能化的提醒（例如，"您与[某人]上次深入交流已是两周前，是否考虑问候一下？"）。**
*   **人际关系分析与建议 (Relationship Analysis & Suggestions)：**
    *   亲密度分析： **AI基于互动频率、沟通情感倾向（从记录文本中分析）、共同经历的积极性、重要事件的参与度等多维度数据，综合量化关系亲密度。**
    *   印象分析： **AI分析用户在日记中描述人物的用词、语气及情感色彩，以及与该人物相关的事件记录，辅助洞察用户对该人物的潜在印象，或该人物可能给用户留下的印象。**
    *   关系维护建议： **AI基于亲密度分析、印象分析及用户设定的关系目标，生成个性化的关系维护行动建议和沟通策略（例如，建议联系某位久未联系的朋友，或针对特定纪念日提出庆祝或祝福建议，甚至提供沟通开场白参考）。**
*   **数据可视化与呈现 (Data Visualization & Presentation)：**
    *   关系网构建： 清晰展示用户的社交网络图谱。**AI辅助：识别关系网中的关键节点、连接强度，辅助理解社交结构。**
    *   足迹地图： 记录与每个人互动轨迹，见证关系演变。
    *   时间线记录： 生成与朋友交往的周期时间线，以及个人整体的人际交往时间线。
    *   朋友档案卡片： 生成精致的、可分享的朋友档案卡片。
*   **组织与管理 (Organization & Management)：**
    *   通过标签、分类等方式对朋友和社交圈子进行划分和管理。**AI辅助：根据人物特征、互动历史、共同圈子等信息，智能推荐标签或圈子划分方案。**
*   **情商辅助 (EQ Assistance)：**
    *   通过记录和提醒，帮助用户表现得更细心、周到，从而在他人看来更具情商。**AI辅助：分析用户记录的社交互动场景（用户授权后），提供沟通方式的反馈（如识别潜在误解风险），建议更积极或共情的表达。**
    *   辅助用户逐步养成更舒适的情商思维和人际交往习惯。**AI辅助：提供基于情景的互动练习、角色扮演或沟通技巧学习资源，帮助用户在模拟环境中提升交往技巧，并根据用户目标和记录提供个性化鼓励和微习惯建议。**

### 2. 主要需求/产品目标 (Requirements/Product Goals)：

*   **全面的信息记录：**
    *   能够记录朋友（及其他联系人）的基础信息（爱好、口味等）。
    *   能够结构化、分类记录与朋友间的往来和重要事件（重要对话、事件、会面、金钱往来等），超越简单备忘。**AI驱动：利用AI进行信息提取、摘要与智能分类，提升记录效率和深度。**
*   **高效的组织管理：**
    *   支持通过标签、分类等方式对朋友和圈子进行有效划分。**AI驱动：AI智能推荐标签与圈子，简化管理操作。**
*   **及时的互动提醒：**
    *   能够在与朋友的往来中，针对关键节点进行提醒。**AI驱动：更智能地预测和建议提醒内容与时机。**
*   **深度的关系洞察：**
    *   能够对记录的数据进行分析，并提供与朋友交往的建议。**AI驱动：由AI执行深度数据分析，生成个性化、可行动的交往建议。**
    *   能够基于数据进行客观分析，如亲密度、他人印象等。**AI驱动：AI模型进行多维度、更客观的关系状态评估。**
*   **清晰的关系呈现：**
    *   能够根据记录数据，形成个人与朋友的关系记录，包括关系网、圈子记录、与朋友的完整交往时间线，以及个人整体的交往时间线。
    *   能够生成可分享的、精致的朋友档案卡片。
*   **提升用户情商与关系质量：**
    *   帮助用户记住重要细节，从而被视为靠谱、有情商。
    *   将情商提升的方法融入工具，辅助用户处理人际关系。**AI驱动：AI提供个性化反馈、情景模拟、沟通策略和持续的习惯养成支持。**
    *   成为用户处理人际关系的得力助手，让用户在复杂人际交往中游刃有余。
*   **生活记录工具：**
    *   也可作为以"人"为维度的生活记录工具，长期记录可形成与某人的故事集、回忆录。

